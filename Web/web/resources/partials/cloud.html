<!-- This file is subject to the terms and conditions defined   in file "LICENSE.txt",
which is part of the GRAPPBOX source code package.
COPYRIGHT GRAPPBOX. ALL RIGHTS RESERVED. -->

<!-- Cloud -->
<section class="cloud">
  <div class="page-header light {[{ ::path.colors[path.current] + '-background' }]}">
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 no-padding text-center">
      <img src="../resources/img/app/cloud.svg" width="300" height="auto" alt="Cloud">
    </div>
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 no-padding title">
      <h1>Cloud</h1>
      <p>Welcome to your storage area! Use the toolbar below to interact with your files and folders, or simply click and double click to respectively select or download/enter a file/folder.</p>
    </div>
    <div class="clearfix"></div>
  </div>

  <div class="box-row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
      <div data-ng-if="!data.loaded">
        <div class="spinner section">
          <svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg>
        </div>
      </div>
      <div data-ng-if="data.loaded">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <div data-ng-if="data.valid && data.authorized >= 1">

            <!-- Toolbox -->
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding text-center toolbox">
              <div class="box no-padding">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                  <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 no-padding">
                    <a href="" data-ng-click="view_accessParentObject()" class="{[{ ::path.colors[path.current] + '-hover' }]}" data-ng-disabled="{[{ !button.parent ? 'true' : 'false' }]}"><i class="material-icons" aria-hidden="true">arrow_back</i>Parent folder</a>
                  </div>
                  <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 no-padding" data-ng-if="data.authorized == 2">
                    <a href="" class="{[{ ::path.colors[path.current] + '-hover' }]}" data-ng-click="view_onNewFolder()">
                      <i class="material-icons" aria-hidden="true">create_new_folder</i>Add folder</a>
                  </div>
                  <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 no-padding" id="view_newFileWrapper" data-ng-if="data.authorized == 2">
                    <label for="view_newFileInput" class="{[{ ::path.colors[path.current] + '-hover' }]}">
                      <i class="material-icons" aria-hidden="true">file_upload</i>Upload file<input id="view_newFileInput" type="file" data-ng-model="newFile.input" data-ng-change="view_onNewFile()" base-sixty-four-input>
                    </label>
                  </div>
                  <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 no-padding" data-ng-if="data.authorized == 2">
                    <a href="" data-ng-click="view_deleteObject()" class="{[{ ::path.colors[path.current] + '-hover' }]}" data-ng-disabled="{[{ !button.delete ? 'true' : 'false' }]}"><i class="material-icons" aria-hidden="true">delete</i>Delete</a>
                  </div>                  
                </div>
                <div class="clearfix"></div>
              </div>
            </div>

            <!-- Breadcrumb -->
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding breadcrumb">
              <div class="box">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                  <p class="no-padding">{[{ data.formatObjectPath(filePath.current) }]}</p>
                </div>
                <div class="clearfix"></div>
              </div>
            </div>

            <!-- Content -->
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding content">
              <div class="box no-padding" data-ng-if="data.objects">
                <div class="table-responsive">
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr>
                        <th class="col-lg-8 col-md-8 col-sm-8 col-xs-8">Name</th>
                        <th class="col-lg-1 col-md-1 col-sm-1 col-xs-1 text-center">Security</th>
                        <th class="col-lg-2 col-md-2 col-sm-2 col-xs-2 text-center">Last modification</th>
                        <th class="col-lg-1 col-md-1 col-sm-1 col-xs-1 text-center">Size</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr data-ng-repeat="object in data.objects" data-ng-click="view_selectObject(object)" data-ng-dblClick="view_accessObject(object)" class="{[{ selected.current.name == object.filename ? path.colors[path.current] + '-background selected' : '' }]}">
                        <td><i class="material-icons" aria-hidden="true">{[{ object.type == 'file' ? 'insert_drive_file' : 'folder' }]}</i>{[{ ::object.filename }]}</td>
                        <td class="text-center"><i class="material-icons standalone" aria-hidden="true">{[{ object.is_secured ? 'lock' : 'lock_open' }]}</i></td>
                        <td class="text-center">{[{ data.formatObjectDate(object.last_modified.date) }]}</td>
                        <td class="text-center">{[{ data.formatObjectSize(object.size) }]}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div data-ng-if="!data.objects">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                  <div class="box error">
                    <p><i class="material-icons" aria-hidden="true">help</i>This folder is empty.<br><span>Upload a file to begin.</span></p>
                  </div>
                </div>
                <div class="clearfix"></div>
              </div>
              <div class="clearfix"></div>
            </div>
          </div>

          <div data-ng-if="data.valid && data.authorized == 0">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
              <div class="box error">
                <p><i class="material-icons" aria-hidden="true">block</i>You don't have access to this section.<br><span>Please contact your project manager for more.</span></p>
              </div>
            </div>
            <div class="clearfix"></div>
          </div>
          <div data-ng-if="!data.valid">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
              <div class="box error">
                <p><i class="material-icons" aria-hidden="true">error</i>Something is wrong with GrappBox.<br><span>Please try again.</span></p>
              </div>
            </div>
            <div class="clearfix"></div>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Folder creation -->
<script type="text/ng-template" id="view_setNewFolder.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_setNewFolderFailure()">×</button>
    <h3 class="modal-title">Folder creation</h3>
  </div>
  <div class="modal-body">
    <p>Please enter the name of your new folder.</p>
    <form>
      <fieldset>
        <div class="form-group label-floating {[{ newFolder.error ? 'has-error' : '' }]}">
          <label for="view_newFolder" class="control-label">Folder name</label>
          <input id="view_newFolder" type="text" class="form-control" data-ng-model="newFolder.name" required autofocus>
        </div>
      </fieldset>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_setNewFolderFailure()">Cancel</button>
    <button type="submit" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_setNewFolderSuccess()">Validate</button>
  </div>
</script>

<!-- Password set prompt -->
<script type="text/ng-template" id="view_isNewFileProtected.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_newFileIsNotProtected()">×</button>  
    <h3 class="modal-title">File security</h3>
  </div>
  <div class="modal-body">
    <p>Do you want to set a password on this file?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_newFileIsNotProtected()">No</button>
    <button type="button" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_newFileIsProtected()">Set password</button>
  </div>
</script>

<!-- Password input -->
<script type="text/ng-template" id="view_setNewFileFirstPassword.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_newFileFirstPasswordFailure()">×</button>
    <h3 class="modal-title">File security</h3>
  </div>
  <div class="modal-body">
    <p>Please set a password for this file.</p>
    <form>
      <fieldset>
        <div class="form-group label-floating {[{ newFile.error ? 'has-error' : '' }]}">
          <label for="view_newFileFirstPassword" class="control-label">File password</label>
          <input id="view_newFileFirstPassword" type="password" class="form-control" data-ng-model="newFile.password" required autofocus>
        </div>
      </fieldset>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_newFileFirstPasswordFailure()">Cancel</button>
    <button type="submit" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_newFileFirstPasswordSuccess()">Set password</button>
  </div>
</script>

<!-- Confirmation password input -->
<script type="text/ng-template" id="view_setNewFileSecondPassword.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_newFileSecondPasswordFailure()">×</button>  
    <h3 class="modal-title">File security</h3>
  </div>
  <div class="modal-body">
    <p>Please enter your password again to confirm it.</p>
    <form>
      <fieldset>
        <div class="form-group label-floating {[{ newFile.error ? 'has-error' : '' }]}">
          <label for="view_newFileSecondPassword" class="control-label">File password</label>
          <input id="view_newFileSecondPassword" type="password" class="form-control" data-ng-model="newFile.password_confirmation" required autofocus>
        </div>
      </fieldset>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_newFileSecondPasswordFailure()">Cancel</button>
    <button type="button" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_newFileSecondPasswordSuccess()">Confirm password</button>
  </div>
</script>

<!-- Password prompt -->
<script type="text/ng-template" id="view_filePasswordCheck.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_filePasswordCheckFailure()">×</button>    
    <h3 class="modal-title">File security</h3>
  </div>
  <div class="modal-body">
    <p>This file is protected.</p>
    <form>
      <fieldset>
        <div class="form-group label-floating">
          <label for="view_filePassword" class="control-label {[{ selected.error ? 'has-error' : '' }]}">File password</label>
          <input id="view_filePassword" type="password" class="form-control" data-ng-model="selected.password" required autofocus>
        </div>
      </fieldset>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_filePasswordCheckFailure()">Cancel</button>
    <button type="button" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_filePasswordCheckSuccess()"><i class="fa fa-check"></i>Validate</button>
  </div>
</script>

<!-- Safe password prompt -->
<script type="text/ng-template" id="view_safePasswordCheck.html">
  <div class="modal-header">
    <button type="button" class="close gray-hover" aria-hidden="true" data-ng-click="view_safePasswordCheckFailure()">×</button>    
    <h3 class="modal-title">File security</h3>
  </div>
  <div class="modal-body">
    <p>The "Safe" folder is protected.</p>
    <form>
      <fieldset>
        <div class="form-group label-floating {[{ safe.error ? 'has-error' : '' }]}">
          <label for="view_safePassword" class="control-label">"Safe" password</label>
          <input id="view_safePassword" type="password" class="form-control" data-ng-model="safe.password" required autofocus>
        </div>
      </fieldset>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn gray-color gray-background-hover white-hover" data-ng-click="view_safePasswordCheckFailure()">Cancel</button>
    <button type="submit" class="btn {[{ ::path.colors[path.current] + '-color' }]} {[{ ::path.colors[path.current] + '-background-hover' }]} white-hover" data-ng-click="view_safePasswordCheckSuccess()">Validate</button>
  </div>
</script>