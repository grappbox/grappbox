<!--
    Summary: Here is the main page alias the Dashboard
-->

<ion-view>
    <ion-nav-title>Dashboard</ion-nav-title>
    <ion-tabs class="tabs-dark tabs-striped">

        <!-- Team Occupation -->
        <ion-tab title="Teams">
            <ion-pane>
                <ion-content overflow-scroll="false">
                    <!-- Refresher -->
                    <ion-refresher pulling-text="Pull to refresh..."
                                   on-refresh="doRefreshTeamOccupation()">
                    </ion-refresher>
                    <div class="item item-divider">
                        Team Occupation
                    </div>
                    <div class="list">
                        <a class="item item-avatar"
                           ng-repeat="teamOccupation in teamOccupationTab"
                           ui-sref="app.user({userId: teamOccupation.users.id})">
                            <img data-ng-src="data:image/png;base64, {{teamOccupation.image}}" />
                            <h2>{{ teamOccupation.users.firstname }} {{ teamOccupation.users.lastname }}</h2>
                            <h3>{{ teamOccupation.name }}</h3>
                            <h3>{{ teamOccupation.occupation }}</h3>
                            <h3>Tasks begun: {{ teamOccupation.number_of_tasks_begun }}</h3>
                            <h3>Ongoing Tasks: {{ teamOccupation.number_of_ongoing_tasks }}</h3>
                        </a>
                    </div>
                </ion-content>
            </ion-pane>
        </ion-tab>

        <!-- Next Meeting -->
        <ion-tab title="Meetings">
            <ion-pane>
                <ion-content overflow-scroll="false">
                    <!-- Refresher -->
                    <ion-refresher pulling-text="Pull to refresh..."
                                   on-refresh="doRefreshNextMeetings()">
                    </ion-refresher>
                    <div class="item item-divider">Next Meetings</div>
                    <ion-list>
                        <ion-item class="item-body">
                            <a class="item item-thumbnail-left"
                               ng-repeat="nextMeeting in nextMeetingsTab"
                               ui-sref="app.nextMeeting({nextMeetingId: nextMeeting.user_id})">
                                <img data-ng-src="data:image/png;base64, {{nextMeeting.projects.logo}}" />
                                <h2>{{ nextMeeting.type }}: {{ nextMeeting.title }}</h2>
                                <p><strong>Project: </strong> {{ nextMeeting.projects.name }}</p>
                                <p>"{{ nextMeeting.description }}"</p>
                                <p class="icon-left ion-ios-calendar-outline"> {{ nextMeeting.begin_date.date }}</p>
                                <p class="icon-left ion-ios-clock-outline"> {{ nextMeeting.end_date.date }}</p>
                            </a>
                        </ion-item>
                    </ion-list>
                </ion-content>
            </ion-pane>
        </ion-tab>

        <!-- Global Progress -->
        <ion-tab title="Progress">
            <ion-pane>
                <ion-content overflow-scroll="false">
                    <!-- Refresher -->
                    <ion-refresher pulling-text="Pull to refresh..."
                                   on-refresh="doRefreshGlobalProgress()">
                    </ion-refresher>
                    <div class="item item-divider">
                        Global Progress
                    </div>
                    <div class="list">
                        <a class="item item-thumbnail-left"
                           ng-repeat="globalProgress in globalProgressTab"
                           ui-sref="app.project({projectId: globalProgress.project_id})">
                            <img data-ng-src="data:image/png;base64, {{globalProgress.project_logo}}" />
                            <h2>{{ globalProgress.project_name }}</h2>
                            <h3 class="icon-left ion-ios-people-outline"> {{ globalProgress.project_company }}</h3>
                            <h4 class="icon-left ion-ios-telephone-outline"> {{ globalProgress.project_phone }}</h4>
                            <h4 class="icon-left ion-ios-paperplane-outline"> {{ globalProgress.contact_mail }}</h4>
                            <h4 class="icon-left ion-ios-list-outline"> {{ globalProgress.number_finished_tasks }} / {{ globalProgress.number_ongoing_tasks }} tasks done</h4>
                            <h4 class="icon-left ion-ios-email-outline"> {{ globalProgress.number_messages }} messages</h4>
                            <h4 class="icon-left ion-bug"> {{ globalProgress.number_bugs }} problems</h4>
                        </a>
                    </div>
                </ion-content>
            </ion-pane>
        </ion-tab>
    </ion-tabs>
</ion-view>